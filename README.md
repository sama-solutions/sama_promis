# üèóÔ∏è SAMA PROMIS - Program Management Information System

[![Odoo Version](https://img.shields.io/badge/Odoo-18.0-blue.svg)](https://github.com/odoo/odoo)
[![License](https://img.shields.io/badge/License-LGPL--3-green.svg)](https://www.gnu.org/licenses/lgpl-3.0)
[![Author](https://img.shields.io/badge/Author-SAMA%20Solutions-orange.svg)](https://www.samaetat.sn)
[![Community Edition](https://img.shields.io/badge/Edition-Community-brightgreen.svg)](https://www.odoo.com/page/editions)

## ‚ö†Ô∏è Compatibilit√© Odoo 18 Community Edition

**Ce module est 100% compatible avec Odoo 18 Community Edition.**

### Pr√©requis Techniques
- **Python**: 3.11 ou sup√©rieur
- **PostgreSQL**: 13 ou sup√©rieur
- **Odoo**: 18.0 Community Edition

### Modules Odoo Requis (CE uniquement)
- ‚úÖ `base` - Module de base Odoo
- ‚úÖ `mail` - Syst√®me de messagerie et notifications
- ‚úÖ `website` - Portail public
- ‚úÖ `project` - Gestion de projets

### ‚ö†Ô∏è Modules NON Requis
Ce module **NE D√âPEND PAS** des modules suivants (Enterprise/absents de CE):
- ‚ùå `account` - Module comptabilit√© (Enterprise)

### Fonctionnalit√©s D√©sactiv√©es (n√©cessitent Enterprise)
Les fonctionnalit√©s suivantes sont d√©sactiv√©es car elles n√©cessitent le module `account` (Enterprise):
- G√©n√©ration automatique d'√©critures comptables
- Int√©gration avec les journaux comptables
- Paiements comptables automatiques

**Alternative CE**: Le module utilise un syst√®me de suivi financier simplifi√© avec des champs mon√©taires directs, sans int√©gration comptable.

üìñ **Documentation compl√®te**: Voir [ODOO18_CE_COMPATIBILITY.md](./ODOO18_CE_COMPATIBILITY.md)

## üìã Description

**SAMA PROMIS** est un syst√®me de gestion de l'information des programmes (PMIS) con√ßu pour la gestion des projets de bailleurs de fonds internationaux. Il utilise une architecture micromodules pour une flexibilit√© et une r√©silience maximales.

## ‚ú® Fonctionnalit√©s Principales

### üèóÔ∏è **Architecture Micromodules**
- **Core** - Mod√®les de base, QR codes, workflows, audit
- **Projects** - Gestion des projets avec cycles de vie complets
- **Public Portal** - Dashboard "PROMISPUBLIC" et page citoyenne
- **Calls** - Appels √† propositions
- **Contracts** - Contrats et signatures √©lectroniques
- **Payments** - Gestion des paiements
- **Evaluations** - √âvaluations et indicateurs

### üéØ **Gestion de Projets**
- Cycles de vie complets avec boutons d'action
- Workflows automatis√©s
- Suivi des √©tapes et jalons
- Gestion des ressources et budgets
- Rapports de progression

### üìä **Dashboard Public**
- Interface "PROMISPUBLIC" moderne
- Cartes interactives et filtres
- Visualisation des donn√©es en temps r√©el
- Transparence des projets publics

### üë• **Page Citoyenne**
- Interface "SAMA PROMIS ET MOI"
- Acc√®s citoyen aux informations
- Participation et feedback
- Suivi des projets locaux

### üîç **QR Codes Automatiques**
- G√©n√©ration automatique pour tous les mod√®les
- Tra√ßabilit√© compl√®te
- Acc√®s rapide aux informations
- Int√©gration mobile

### üìã **Appels √† Propositions**
- Gestion compl√®te des appels
- Soumission en ligne
- √âvaluation et s√©lection
- Suivi des candidatures

### üìÑ **Contrats et Signatures**
- Gestion des contrats
- Signatures √©lectroniques
- Suivi des obligations
- Archivage num√©rique

### üí∞ **Gestion des Paiements**
- Planification des paiements
- Suivi des d√©caissements
- Rapports financiers
- Int√©gration comptable

### üìà **√âvaluations et Indicateurs**
- Syst√®me d'√©valuation
- Indicateurs de performance
- Rapports d'impact
- Tableaux de bord analytiques

## üöÄ Installation

### Pr√©requis
- **Odoo**: 18.0 Community Edition
- **Python**: 3.11 ou sup√©rieur
- **PostgreSQL**: 13 ou sup√©rieur
- **D√©pendances Python**: `qrcode`

### V√©rification de Compatibilit√©

Avant l'installation, v√©rifiez que vous utilisez:
```bash
# V√©rifier la version Python
python3 --version  # Doit √™tre >= 3.11

# V√©rifier la version PostgreSQL
psql --version  # Doit √™tre >= 13

# V√©rifier la version Odoo
odoo --version  # Doit √™tre 18.0 Community Edition
```

### Installation du module

1. **Cloner le repository :**
```bash
git clone https://github.com/sama-solutions/sama_promis.git
cd sama_promis
```

2. **Installer les d√©pendances Python :**
```bash
pip install qrcode
```

3. **Copier dans addons :**
```bash
cp -r sama_promis /path/to/odoo/addons/
```

4. **Red√©marrer Odoo :**
```bash
sudo systemctl restart odoo
# ou
odoo-bin -u sama_promis -d your_database
```

5. **Installer le module :**
- Aller dans Apps
- Rechercher "SAMA PROMIS"
- Cliquer sur "Install"

### V√©rification Post-Installation

Apr√®s installation, v√©rifiez que:
- ‚úÖ Aucune erreur li√©e au module `account`
- ‚úÖ Toutes les vues s'affichent correctement
- ‚úÖ Les listes sont √©ditables en masse (`multi_edit`)
- ‚úÖ Les QR codes se g√©n√®rent correctement

## Validation de l'Installation

### Script de Validation Automatique

Apr√®s l'installation, ex√©cutez le script de validation pour v√©rifier que tous les composants sont correctement charg√©s:

```bash
# Rendre le script ex√©cutable
chmod +x scripts/validate_module_loading.py

# Ex√©cuter le script
python3 scripts/validate_module_loading.py
```

**R√©sultat attendu:**
```
============================================================
SAMA PROMIS - Module Loading Validation
============================================================

[1] Checking Mixin Files...
‚úì Workflow Mixin exists: /path/to/shared/mixins/workflow_mixin.py
‚úì Audit Mixin exists: /path/to/shared/mixins/audit_mixin.py

[2] Checking Import Order...
‚úì Import order correct in __init__.py: shared before models

[3] Checking Model Names...
‚úì Model name correct in models/call_for_proposal.py: sama.promis.call.proposal
‚úì Model name correct in shared/mixins/workflow_mixin.py: sama.promis.workflow.mixin
‚úì Model name correct in shared/mixins/audit_mixin.py: sama.promis.audit.mixin

[4] Checking Mixin Inheritance...
‚úì Mixin inheritance found in models/compliance_task.py: sama.promis.workflow.mixin
‚úì Mixin inheritance found in micromodules/core/models/base_model.py: sama.promis.workflow.mixin
‚úì Mixin inheritance found in micromodules/core/models/base_model.py: sama.promis.audit.mixin

[5] Checking call_for_proposal References...
‚úì Correct model name in micromodules/projects/models/project.py

[6] Checking One2many Relations...
‚úì Correct One2many relation in call_for_proposal.py

============================================================
‚úì ALL CHECKS PASSED! Module should load correctly.
============================================================
```

### V√©rification Manuelle

Si vous pr√©f√©rez v√©rifier manuellement:

1. **V√©rifier l'ordre d'import dans `__init__.py`:**
   ```python
   from . import shared        # DOIT √™tre en premier
   from . import models
   from . import controllers
   from . import micromodules
   ```

2. **V√©rifier le nom du mod√®le dans `micromodules/projects/models/project.py` ligne 200:**
   ```python
   call_for_proposal_id = fields.Many2one(
       'sama.promis.call.proposal',  # Correct (sans "for")
       ...
   )
   ```

3. **V√©rifier la relation One2many dans `models/call_for_proposal.py` ligne 46:**
   ```python
   project_ids = fields.One2many('project.project', 'call_for_proposal_id',
                               string="Projets Soumis")
   ```

### D√©pannage

**Erreur: "Model not found: sama.promis.workflow.mixin"**
- V√©rifiez que `from . import shared` est pr√©sent dans `__init__.py`
- V√©rifiez que `from . import mixins` est pr√©sent dans `shared/__init__.py`
- V√©rifiez que les fichiers mixin existent dans `shared/mixins/`

**Erreur: "Field 'call_for_proposal_id' does not exist"**
- V√©rifiez que le nom du mod√®le est `sama.promis.call.proposal` (sans "for")
- V√©rifiez que la relation One2many pointe vers `project.project`

**Erreur: "Invalid field on model"**
- Ex√©cutez le script de validation pour identifier le probl√®me exact
- V√©rifiez les logs Odoo pour plus de d√©tails

## üìñ Configuration

### Configuration initiale
1. Configurer les param√®tres du syst√®me
2. Cr√©er les types de projets
3. D√©finir les workflows
4. Param√©trer les r√¥les et permissions

### Configuration des micromodules
1. Activer les micromodules n√©cessaires
2. Configurer les int√©grations
3. Personnaliser les dashboards
4. D√©finir les indicateurs

## üõ†Ô∏è D√©veloppement

### Structure du module
```
sama_promis/
‚îú‚îÄ‚îÄ __manifest__.py          # Manifeste du module
‚îú‚îÄ‚îÄ __init__.py             # Initialisation
‚îú‚îÄ‚îÄ models/                 # Mod√®les de donn√©es
‚îú‚îÄ‚îÄ views/                  # Vues et interfaces
‚îú‚îÄ‚îÄ controllers/            # Contr√¥leurs web
‚îú‚îÄ‚îÄ data/                   # Donn√©es initiales
‚îú‚îÄ‚îÄ security/               # S√©curit√© et permissions
‚îú‚îÄ‚îÄ static/                 # Fichiers statiques
‚îú‚îÄ‚îÄ templates/              # Templates web
‚îú‚îÄ‚îÄ micromodules/           # Architecture micromodules
‚îú‚îÄ‚îÄ shared/                 # Composants partag√©s
‚îú‚îÄ‚îÄ wizard/                 # Assistants
‚îî‚îÄ‚îÄ tests/                  # Tests unitaires
```

### Micromodules principaux
- `core/` - Fonctionnalit√©s de base
- `projects/` - Gestion de projets
- `public_portal/` - Portail public
- `calls/` - Appels √† propositions
- `contracts/` - Gestion des contrats
- `payments/` - Syst√®me de paiement
- `evaluations/` - √âvaluations

## üß™ Tests

### Lancer les tests
```bash
python -m pytest tests/
```

### Tests disponibles
- Tests unitaires des mod√®les
- Tests d'int√©gration des micromodules
- Tests de l'interface web
- Tests de performance

## üìà Versions

### Version actuelle : 18.0.3.1.0 (Version Hybride) üéÜ

**Cette version combine le meilleur de deux versions pr√©c√©dentes :**
- Base moderne avec architecture micromodules
- Am√©liorations techniques de la version de d√©veloppement
- Documentation et outils de migration complets

#### üéØ **Fonctionnalit√©s principales :**
- ‚úÖ Architecture micromodules compl√®te
- ‚úÖ Dashboard public PROMISPUBLIC
- ‚úÖ Page citoyenne "SAMA PROMIS ET MOI"
- ‚úÖ QR codes automatiques
- ‚úÖ Cycles de vie des projets
- ‚úÖ Appels √† propositions
- ‚úÖ Gestion des contrats (am√©lior√©e)
- ‚úÖ Mod√®les de contrats avanc√©s avec aper√ßu
- ‚úÖ Syst√®me de paiements
- ‚úÖ √âvaluations et indicateurs
- ‚úÖ Scripts de migration robustes
- ‚úÖ Documentation technique compl√®te

#### üîÑ **Historique des versions :**
- `18.0.3.1.0` - Version hybride (actuelle)
- `18.0.3.0.0` - Version avec architecture micromodules
- `18.0.2.0.2` - Version de d√©veloppement avec am√©liorations

## ü§ù Contribution

### Comment contribuer
1. Fork le projet
2. Cr√©er une branche feature
3. Commiter vos changements
4. Pousser vers la branche
5. Ouvrir une Pull Request

### Standards de code
- Suivre les conventions Odoo
- Documenter le code
- Ajouter des tests
- Respecter l'architecture micromodules

## üìû Support

### Contact
- **Auteur :** SAMA Transparent State Solutions
- **Website :** https://www.samaetat.sn
- **Email :** contact@samaetat.sn

### Issues
Pour signaler un bug ou demander une fonctionnalit√© :
[Cr√©er une issue](https://github.com/sama-solutions/sama_promis/issues)

## üìÑ Licence

Ce projet est sous licence LGPL-3. Voir le fichier [LICENSE](LICENSE) pour plus de d√©tails.

## üôè Remerciements

Merci √† tous les contributeurs et √† la communaut√© Odoo pour leur soutien.

---

**D√©velopp√© avec ‚ù§Ô∏è par SAMA Transparent State Solutions**